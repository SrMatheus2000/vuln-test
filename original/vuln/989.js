function(e,t){var n,r,o,i,a,s=this.getSelection(),d=this._doc.createDocumentFragment(),l=this.createElement("DIV");t&&(n=e.indexOf("<!--StartFragment-->"),r=e.lastIndexOf("<!--EndFragment-->"),n>-1&&r>-1&&(e=e.slice(n+20,r))),l.innerHTML=e,d.appendChild(N(l)),this.saveUndoState(s);try{for(o=this._root,i=d,a={fragment:d,preventDefault:function(){this.defaultPrevented=!0},defaultPrevented:!1},gn(d,d,this),Ht(d),Kt(d,null),Wt(d),d.normalize();i=c(i,d);)_(i,null);t&&this.fireEvent("willPaste",a),a.defaultPrevented||(mt(s,a.fragment,o),it||this._docWasChanged(),s.collapse(!1),this._ensureBottomLine()),this.setSelection(s),this._updatePath(s,!0)}catch(h){this.didError(h)}return this}